# Проект по поиску похожих фильмов на TMDB

Хочешь найти фильмы максимально похожие на те, которые так любишь? Ты попал по адресу.

Репозиторий представляет собой набор различных скриптов, которые помогут тебе подключится к [API зарубежной базы фильмов TMDB](https://www.themoviedb.org/documentation/api), создать у себя ее локальную копию и найти фильмы схожие с твоими любимиыми.

## Запуск скриптов

- Скачайте репозиторий с кодом.
- Установите зависимости командой `pip install -r requirements.txt`.
- Запустите выбранный скрипт командой `python3 SCRIPT_NAME.py` и следуйте выводимым в консоль инструкциям.

Для запуска большинства скриптов вам понадобиться API Key TMDB. Инструкцию по его получению вы можете найти в разделе `How do I apply for an API key?` [API документации TMDB](https://www.themoviedb.org/documentation/api).

## tmdb_helpers.py

Вспомогательный скрипт, где хранятся функции, помогающие в работе с API TMDB:
- `make_tmdb_api_request` - функция осуществляющая непосредственный запрос по API.
- `load_json_data_from_url` - функция загружающая данные в json формате по переданному url.
- `get_user_api_key` - функция используемая для валидации введенного пользователем ключа API.

## hello_api_TMDB.py

Скрипт проверки корректности подключения к API TMDB.

При вызове данного скрипта, для начала введите ваш API ключ.

Если ключ корректен, вам в консоль будет выведена информация о фильме [пила 2](https://www.themoviedb.org/movie/215-saw-ii).

В случае же, если ваш ключ некорректен, в консоле вы увидите надпись `Invalid api key`

## make_own_db.py

Скрипт создает локальную копию базы данных о фильмах с TMDB.

При помощи функции `load_films` скрипт выгружает данные о фильмах с TMDB и сохраняет их в json файл `MyFilmDB.json`.

По умолчанию скачивается 1000 фильмов. Данный параметр хранится в переменной `films_amount`.

База данных наполняется достаточно продолжительное время. Придется подождать.

В случае нормальной работы скрипта, вы увидите надпись: `please, wait, this operation may take smth like 15-20 minutes`

По ходу скачивания фильмов, также будет выводится процент успешно скаченых фильмов. К примеру: `30 percent complete` при 30% скаченных фильмов.

## own_db_helpers.py

Вспомогательный скрипт, с функцией `load_data`, осуществляющий загрузку данных из json файла. Используется для загрузки данных из локальной базы данных `MyFilmDB.json`.

## search_in_db.py

Скрипт для поиска фильма по ключевой фразе в локальной базе данных. Просто введите путь до локальной базы `MyFilmDB.json` и введите ключевое слово для заголовка фильма.

Содержит функцию `search_for_film`, которая принимая на вход ключевую фразу и данные о фильмах, осуществляет поиск по заголовкам фильмов.

При вызове скрипта указывайте корректный путь до локальной базы данных с фильмами. В случае указания неверного пути, вы получите ошибку: `'File not found, sorry...'`

## find_similar.py

Скрипт позволяет найти фильм, похожий на ваш. При вызове скрипта, укажите путь до локальной базы данных `MyFilmDB.json`, а также название фильма, на который вы желаете найти похожие фильмы.

При помощи функции `find_my_film`, по введенному вами названию фильма, скрипт найдет фильм в базе данных. Если же такого названия нет, то будет выведена следующая ошибка: `No such film in FilmsDB` и скрипт завершит свою работу.

При помощи функции `get_rating`, скрипт определит фильмы схожие с вашим и выведит на экран найденые рекомендации.

Схожесть фильмов определяется по 4 параметрам:
- `belongs_to_collection`. Принадлежность фильма к той же коллекции, что и ваш фильм. К примеру, фильм [пила 2](https://www.themoviedb.org/movie/215-saw-ii) входит в [коллекцию фильмов о пиле](https://www.themoviedb.org/collection/656-saw-collection)
- `original_language`. Язык фильма
- `budget`. Бюджет фильма
- `genres`. Жанр фильма

За совпадение по каждому параметру начисляются очки и в первую очередь выводятся фильмы с наибольшем количеством очков. Принадлежность к коллекции (1000 очков), жанр (500 очков), язык (300 очков), бюджет (100 очков).

По умолчанию выводится 8 рекомендаций. Данный параметр хранится в переменной `num_to_recommend=8` аргументов функции `get_rating`.
